<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!--NewPage-->
<HTML>
<HEAD>
<!-- Generated by javadoc (build 1.6.0_24) on Sun Mar 27 22:47:21 MDT 2011 -->
<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<TITLE>
JavaEncryptor (ESAPI 2.0 2.0_rc11 API)
</TITLE>

<META NAME="date" CONTENT="2011-03-27">

<LINK REL ="stylesheet" TYPE="text/css" HREF="../../../../../stylesheet.css" TITLE="Style">

<SCRIPT type="text/javascript">
function windowTitle()
{
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="JavaEncryptor (ESAPI 2.0 2.0_rc11 API)";
    }
}
</SCRIPT>
<NOSCRIPT>
</NOSCRIPT>

</HEAD>

<BODY BGCOLOR="white" onload="windowTitle();">
<HR>


<!-- ========= START OF TOP NAVBAR ======= -->
<A NAME="navbar_top"><!-- --></A>
<A HREF="#skip-navbar_top" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_top_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/JavaEncryptor.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../org/owasp/esapi/reference/crypto/EncryptedPropertiesUtils.html" title="class in org.owasp.esapi.reference.crypto"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../org/owasp/esapi/reference/crypto/ReferenceEncryptedProperties.html" title="class in org.owasp.esapi.reference.crypto"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/owasp/esapi/reference/crypto/JavaEncryptor.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="JavaEncryptor.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_top"></A>
<!-- ========= END OF TOP NAVBAR ========= -->

<HR>
<!-- ======== START OF CLASS DATA ======== -->
<H2>
<FONT SIZE="-1">
org.owasp.esapi.reference.crypto</FONT>
<BR>
Class JavaEncryptor</H2>
<PRE>
java.lang.Object
  <IMG SRC="../../../../../resources/inherit.gif" ALT="extended by "><B>org.owasp.esapi.reference.crypto.JavaEncryptor</B>
</PRE>
<DL>
<DT><B>All Implemented Interfaces:</B> <DD><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></DD>
</DL>
<HR>
<DL>
<DT><PRE>public final class <B>JavaEncryptor</B><DT>extends java.lang.Object<DT>implements <A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></DL>
</PRE>

<P>
Reference implementation of the <code>Encryptor</code> interface. This implementation
 layers on the JCE provided cryptographic package. Algorithms used are
 configurable in the <code>ESAPI.properties</code> file. The main property
 controlling the selection of this class is <code>ESAPI.Encryptor</code>. Most of
 the other encryption related properties have property names that start with
 the string "Encryptor.".
<P>

<P>
<DL>
<DT><B>Since:</B></DT>
  <DD>June 1, 2007; some methods since ESAPI Java 2.0</DD>
<DT><B>Author:</B></DT>
  <DD>Jeff Williams (jeff.williams .at. aspectsecurity.com) <a
         href="http://www.aspectsecurity.com">Aspect Security</a>, kevin.w.wall@gmail.com, Chris Schmidt (chrisisbeef .at. gmail.com)</DD>
<DT><B>See Also:</B><DD><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi"><CODE>Encryptor</CODE></A></DL>
<HR>

<P>

<!-- ========== METHOD SUMMARY =========== -->

<A NAME="method_summary"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="2"><FONT SIZE="+2">
<B>Method Summary</B></FONT></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)">decrypt</A></B>(<A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A>&nbsp;ciphertext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the provided <A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto"><CODE>CipherText</CODE></A> using the information from it
 and the <i>master encryption key</i> as specified by the property
 <code>Encryptor.MasterKey</code> as defined in the <code>ESAPI.properties</code>
 file.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)">decrypt</A></B>(javax.crypto.SecretKey&nbsp;key,
        <A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A>&nbsp;ciphertext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Decrypts the provided <A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto"><CODE>CipherText</CODE></A> using the information from it
 and the <i>specified secret key</i>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#decrypt(java.lang.String)">decrypt</A></B>(java.lang.String&nbsp;b64IVCiphertext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>Deprecated.</B>&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)">encrypt</A></B>(<A HREF="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</A>&nbsp;plaintext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encrypts the provided plaintext bytes using the cipher transformation
 specified by the property <code>Encryptor.CipherTransformation</code>
 and the <i>master encryption key</i> as specified by the property
 <code>Encryptor.MasterKey</code> as defined in the <code>ESAPI.properties</code> file.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;<A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)">encrypt</A></B>(javax.crypto.SecretKey&nbsp;key,
        <A HREF="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</A>&nbsp;plain)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Encrypts the provided plaintext bytes using the cipher transformation
 specified by the property <code>Encryptor.CipherTransformation</code>
 as defined in the <code>ESAPI.properties</code> file and the
 <i>specified secret key</i>.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#encrypt(java.lang.String)">encrypt</A></B>(java.lang.String&nbsp;plaintext)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>Deprecated.</B>&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;<A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#getInstance()">getInstance</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#getRelativeTimeStamp(long)">getRelativeTimeStamp</A></B>(long&nbsp;offset)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets an absolute timestamp representing an offset from the current time to be used by
 other functions in the library.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;long</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#getTimeStamp()">getTimeStamp</A></B>()</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Gets a timestamp representing the current date and time to be used by
 other functions in the library.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#hash(java.lang.String, java.lang.String)">hash</A></B>(java.lang.String&nbsp;plaintext,
     java.lang.String&nbsp;salt)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string representation of the hash of the provided plaintext and
 salt.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#hash(java.lang.String, java.lang.String, int)">hash</A></B>(java.lang.String&nbsp;plaintext,
     java.lang.String&nbsp;salt,
     int&nbsp;iterations)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Returns a string representation of the hash of the provided plaintext and
 salt.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>static&nbsp;void</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#main(java.lang.String[])">main</A></B>(java.lang.String[]&nbsp;args)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Generates a new strongly random secret key and salt that can be
 copy and pasted in the <b>ESAPI.properties</b> file.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#seal(java.lang.String, long)">seal</A></B>(java.lang.String&nbsp;data,
     long&nbsp;expiration)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Creates a seal that binds a set of data and includes an expiration timestamp.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#sign(java.lang.String)">sign</A></B>(java.lang.String&nbsp;data)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Create a digital signature for the provided data and return it in a
 string.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;java.lang.String</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#unseal(java.lang.String)">unseal</A></B>(java.lang.String&nbsp;seal)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Unseals data (created with the seal method) and throws an exception
 describing any of the various problems that could exist with a seal, such
 as an invalid seal format, expired timestamp, or decryption error.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#verifySeal(java.lang.String)">verifySeal</A></B>(java.lang.String&nbsp;seal)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies a seal (created with the seal method) and throws an exception
 describing any of the various problems that could exist with a seal, such
 as an invalid seal format, expired timestamp, or data mismatch.</TD>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD ALIGN="right" VALIGN="top" WIDTH="1%"><FONT SIZE="-1">
<CODE>&nbsp;boolean</CODE></FONT></TD>
<TD><CODE><B><A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html#verifySignature(java.lang.String, java.lang.String)">verifySignature</A></B>(java.lang.String&nbsp;signature,
                java.lang.String&nbsp;data)</CODE>

<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Verifies a digital signature (created with the sign method) and returns
 the boolean result.</TD>
</TR>
</TABLE>
&nbsp;<A NAME="methods_inherited_from_class_java.lang.Object"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#EEEEFF" CLASS="TableSubHeadingColor">
<TH ALIGN="left"><B>Methods inherited from class java.lang.Object</B></TH>
</TR>
<TR BGCOLOR="white" CLASS="TableRowColor">
<TD><CODE>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</CODE></TD>
</TR>
</TABLE>
&nbsp;
<P>

<!-- ============ METHOD DETAIL ========== -->

<A NAME="method_detail"><!-- --></A>
<TABLE BORDER="1" WIDTH="100%" CELLPADDING="3" CELLSPACING="0" SUMMARY="">
<TR BGCOLOR="#CCCCFF" CLASS="TableHeadingColor">
<TH ALIGN="left" COLSPAN="1"><FONT SIZE="+2">
<B>Method Detail</B></FONT></TH>
</TR>
</TABLE>

<A NAME="getInstance()"><!-- --></A><H3>
getInstance</H3>
<PRE>
public static <A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A> <B>getInstance</B>()
                             throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD><DL>
</DL>
</DD>
<DD><DL>

<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="main(java.lang.String[])"><!-- --></A><H3>
main</H3>
<PRE>
public static void <B>main</B>(java.lang.String[]&nbsp;args)
                 throws java.lang.Exception</PRE>
<DL>
<DD>Generates a new strongly random secret key and salt that can be
 copy and pasted in the <b>ESAPI.properties</b> file.
<P>
<DD><DL>
</DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>args</CODE> - Set first argument to "-print" to display available algorithms on standard output.
<DT><B>Throws:</B>
<DD><CODE>java.lang.Exception</CODE> - To cover a multitude of sins, mostly in configuring ESAPI.properties.</DL>
</DD>
</DL>
<HR>

<A NAME="hash(java.lang.String, java.lang.String)"><!-- --></A><H3>
hash</H3>
<PRE>
public java.lang.String <B>hash</B>(java.lang.String&nbsp;plaintext,
                             java.lang.String&nbsp;salt)
                      throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Returns a string representation of the hash of the provided plaintext and
 salt. The salt helps to protect against a rainbow table attack by mixing
 in some extra data with the plaintext. Some good choices for a salt might
 be an account name or some other string that is known to the application
 but not to an attacker.
 See <a href="http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/">
 this article</a> for more information about hashing as it pertains to password schemes.
 
 Hashes the data with the supplied salt and the number of iterations specified in
 the ESAPI SecurityConfiguration.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#hash(java.lang.String, java.lang.String)">hash</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>plaintext</CODE> - the plaintext String to encrypt<DD><CODE>salt</CODE> - the salt to add to the plaintext String before hashing
<DT><B>Returns:</B><DD>the encrypted hash of 'plaintext' stored as a String
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - if the specified hash algorithm could not be found or another problem exists with 
      the hashing of 'plaintext'</DL>
</DD>
</DL>
<HR>

<A NAME="hash(java.lang.String, java.lang.String, int)"><!-- --></A><H3>
hash</H3>
<PRE>
public java.lang.String <B>hash</B>(java.lang.String&nbsp;plaintext,
                             java.lang.String&nbsp;salt,
                             int&nbsp;iterations)
                      throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Returns a string representation of the hash of the provided plaintext and
 salt. The salt helps to protect against a rainbow table attack by mixing
 in some extra data with the plaintext. Some good choices for a salt might
 be an account name or some other string that is known to the application
 but not to an attacker. 
 See <a href="http://www.matasano.com/log/958/enough-with-the-rainbow-tables-what-you-need-to-know-about-secure-password-schemes/">
 this article</a> for more information about hashing as it pertains to password schemes.
 
 Hashes the data using the specified algorithm and the Java MessageDigest class. This method
 first adds the salt, a separator (":"), and the data, and then rehashes the specified number of iterations
 in order to help strengthen weak passwords.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#hash(java.lang.String, java.lang.String, int)">hash</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>plaintext</CODE> - the plaintext String to encrypt<DD><CODE>salt</CODE> - the salt to add to the plaintext String before hashing<DD><CODE>iterations</CODE> - the number of times to iterate the hash
<DT><B>Returns:</B><DD>the encrypted hash of 'plaintext' stored as a String
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - if the specified hash algorithm could not be found or another problem exists with 
      the hashing of 'plaintext'</DL>
</DD>
</DL>
<HR>

<A NAME="encrypt(java.lang.String)"><!-- --></A><H3>
encrypt</H3>
<PRE>
<FONT SIZE="-1">@Deprecated
</FONT>public java.lang.String <B>encrypt</B>(java.lang.String&nbsp;plaintext)
                         throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD><B>Deprecated.</B>&nbsp;
<P>
<DD>Convenience method that encrypts plaintext strings the new way (default
 is CBC mode and PKCS5 padding). This encryption method uses the master
 encryption key specified by the <code>Encryptor.MasterKey</code> property
 in <code>ESAPI.properties</code>.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#encrypt(java.lang.String)">encrypt</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>plaintext</CODE> - A String to be encrypted
<DT><B>Returns:</B><DD>A base64-encoded combination of IV + raw ciphertext
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - Thrown when something goes wrong with the
                                                                encryption.<DT><B>See Also:</B><DD><A HREF="../../../../../org/owasp/esapi/Encryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)"><CODE>Encryptor.encrypt(PlainText)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="encrypt(org.owasp.esapi.crypto.PlainText)"><!-- --></A><H3>
encrypt</H3>
<PRE>
public <A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A> <B>encrypt</B>(<A HREF="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</A>&nbsp;plaintext)
                   throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Encrypts the provided plaintext bytes using the cipher transformation
 specified by the property <code>Encryptor.CipherTransformation</code>
 and the <i>master encryption key</i> as specified by the property
 <code>Encryptor.MasterKey</code> as defined in the <code>ESAPI.properties</code> file.
 </p><p>
 This method is preferred over <A HREF="../../../../../org/owasp/esapi/Encryptor.html#encrypt(java.lang.String)"><CODE>Encryptor.encrypt(String)</CODE></A> because it also
 allows encrypting of general byte streams rather than simply strings and
 also because it returns a <code>CipherText</code> object and thus supports
 cipher modes that require an Initialization Vector (IV), such as
 Cipher Block Chaining (CBC).
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)">encrypt</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>plaintext</CODE> - The <code>PlainText</code> to be encrypted.
<DT><B>Returns:</B><DD>the <code>CipherText</code> object from which the raw ciphertext, the
                                IV, the cipher transformation, and many other aspects about
                                the encryption detail may be extracted.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - Thrown if something should go wrong such as
                                the JCE provider cannot be found, the cipher algorithm,
                                cipher mode, or padding scheme not being supported, specifying
                                an unsupported key size, specifying an IV of incorrect length,
                                etc.<DT><B>See Also:</B><DD><A HREF="../../../../../org/owasp/esapi/Encryptor.html#encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)"><CODE>Encryptor.encrypt(SecretKey, PlainText)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)"><!-- --></A><H3>
encrypt</H3>
<PRE>
public <A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A> <B>encrypt</B>(javax.crypto.SecretKey&nbsp;key,
                          <A HREF="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</A>&nbsp;plain)
                   throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Encrypts the provided plaintext bytes using the cipher transformation
 specified by the property <code>Encryptor.CipherTransformation</code>
 as defined in the <code>ESAPI.properties</code> file and the
 <i>specified secret key</i>.
 </p><p>
 This method is similar to <A HREF="../../../../../org/owasp/esapi/Encryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)"><CODE>Encryptor.encrypt(PlainText)</CODE></A> except that it
 permits a specific <code>SecretKey</code> to be used for encryption.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#encrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.PlainText)">encrypt</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - The <code>SecretKey</code> to use for encrypting the plaintext.<DD><CODE>plain</CODE> - The byte stream to be encrypted. Note if a Java
                                <code>String</code> is to be encrypted, it should be converted
                                using <code>"some string".getBytes("UTF-8")</code>.
<DT><B>Returns:</B><DD>the <code>CipherText</code> object from which the raw ciphertext, the
                                IV, the cipher transformation, and many other aspects about
                                the encryption detail may be extracted.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - Thrown if something should go wrong such as
                                the JCE provider cannot be found, the cipher algorithm,
                                cipher mode, or padding scheme not being supported, specifying
                                an unsupported key size, specifying an IV of incorrect length,
                                etc.<DT><B>See Also:</B><DD><A HREF="../../../../../org/owasp/esapi/Encryptor.html#encrypt(org.owasp.esapi.crypto.PlainText)"><CODE>Encryptor.encrypt(PlainText)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="decrypt(java.lang.String)"><!-- --></A><H3>
decrypt</H3>
<PRE>
<FONT SIZE="-1">@Deprecated
</FONT>public java.lang.String <B>decrypt</B>(java.lang.String&nbsp;b64IVCiphertext)
                         throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD><B>Deprecated.</B>&nbsp;
<P>
<DD>Convenience method that decrypts previously encrypted plaintext strings
 that were encrypted using the new encryption mechanism (with CBC mode and
 PKCS5 padding by default).  This decryption method uses the master
 encryption key specified by the <code>Encryptor.MasterKey</code> property
 in <code>ESAPI.properties</code>.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#decrypt(java.lang.String)">decrypt</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>b64IVCiphertext</CODE> - A base64-encoded representation of the
                                                        IV + raw ciphertext string to be decrypted with
                                                        the default master key.
<DT><B>Returns:</B><DD>The plaintext string prior to encryption.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - When something fails with the decryption.<DT><B>See Also:</B><DD><A HREF="../../../../../org/owasp/esapi/Encryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)"><CODE>Encryptor.decrypt(CipherText)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="decrypt(org.owasp.esapi.crypto.CipherText)"><!-- --></A><H3>
decrypt</H3>
<PRE>
public <A HREF="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</A> <B>decrypt</B>(<A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A>&nbsp;ciphertext)
                  throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Decrypts the provided <A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto"><CODE>CipherText</CODE></A> using the information from it
 and the <i>master encryption key</i> as specified by the property
 <code>Encryptor.MasterKey</code> as defined in the <code>ESAPI.properties</code>
 file.
 </p><p>
 This decrypt method is to be preferred over the deprecated
 <A HREF="../../../../../org/owasp/esapi/Encryptor.html#decrypt(java.lang.String)"><CODE>Encryptor.decrypt(String)</CODE></A> method because this method can handle plaintext
 bytes that were encrypted with cipher modes requiring IVs, such as CBC.
 </p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)">decrypt</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>ciphertext</CODE> - The <code>CipherText</code> object to be decrypted.
<DT><B>Returns:</B><DD>The <code>PlainText</code> object resulting from decrypting the specified
                   ciphertext. Note that it it is desired to convert the returned
                   plaintext byte array to a Java String is should be done using
                   <code>new String(byte[], "UTF-8");</code> rather than simply using
                   <code>new String(byte[]);</code> which uses native encoding and may
                   not be portable across hardware and/or OS platforms.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - Thrown if something should go wrong such as
                                the JCE provider cannot be found, the cipher algorithm,
                                cipher mode, or padding scheme not being supported, specifying
                                an unsupported key size, or incorrect encryption key was
                                specified or a <code>PaddingException</code> occurs.<DT><B>See Also:</B><DD><A HREF="../../../../../org/owasp/esapi/Encryptor.html#decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)"><CODE>Encryptor.decrypt(SecretKey, CipherText)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)"><!-- --></A><H3>
decrypt</H3>
<PRE>
public <A HREF="../../../../../org/owasp/esapi/crypto/PlainText.html" title="class in org.owasp.esapi.crypto">PlainText</A> <B>decrypt</B>(javax.crypto.SecretKey&nbsp;key,
                         <A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto">CipherText</A>&nbsp;ciphertext)
                  throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A>,
                         java.lang.IllegalArgumentException</PRE>
<DL>
<DD>Decrypts the provided <A HREF="../../../../../org/owasp/esapi/crypto/CipherText.html" title="class in org.owasp.esapi.crypto"><CODE>CipherText</CODE></A> using the information from it
 and the <i>specified secret key</i>.
 </p><p>
 This decrypt method is similar to <A HREF="../../../../../org/owasp/esapi/Encryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)"><CODE>Encryptor.decrypt(CipherText)</CODE></A> except that
 it allows decrypting with a secret key other than the <i>master secret key</i>.
 </p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#decrypt(javax.crypto.SecretKey, org.owasp.esapi.crypto.CipherText)">decrypt</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>key</CODE> - The <code>SecretKey</code> to use for encrypting the plaintext.<DD><CODE>ciphertext</CODE> - The <code>CipherText</code> object to be decrypted.
<DT><B>Returns:</B><DD>The <code>PlainText</code> object resulting from decrypting the specified
                   ciphertext. Note that it it is desired to convert the returned
                   plaintext byte array to a Java String is should be done using
                   <code>new String(byte[], "UTF-8");</code> rather than simply using
                   <code>new String(byte[]);</code> which uses native encoding and may
                   not be portable across hardware and/or OS platforms.
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - Thrown if something should go wrong such as
                                the JCE provider cannot be found, the cipher algorithm,
                                cipher mode, or padding scheme not being supported, specifying
                                an unsupported key size, or incorrect encryption key was
                                specified or a <code>PaddingException</code> occurs.
<DD><CODE>java.lang.IllegalArgumentException</CODE><DT><B>See Also:</B><DD><A HREF="../../../../../org/owasp/esapi/Encryptor.html#decrypt(org.owasp.esapi.crypto.CipherText)"><CODE>Encryptor.decrypt(CipherText)</CODE></A></DL>
</DD>
</DL>
<HR>

<A NAME="sign(java.lang.String)"><!-- --></A><H3>
sign</H3>
<PRE>
public java.lang.String <B>sign</B>(java.lang.String&nbsp;data)
                      throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Create a digital signature for the provided data and return it in a
 string.
 <p>
 <b>Limitations:</b> A new public/private key pair used for ESAPI 2.0 digital
 signatures with this method and <A HREF="../../../../../org/owasp/esapi/Encryptor.html#verifySignature(java.lang.String, java.lang.String)"><CODE>Encryptor.verifySignature(String, String)</CODE></A>
 are dynamically created when the default reference implementation class,
 <A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html" title="class in org.owasp.esapi.reference.crypto"><CODE>JavaEncryptor</CODE></A> is first created.
 Because this key pair is not persisted nor is the public key shared,
 this method and the corresponding <A HREF="../../../../../org/owasp/esapi/Encryptor.html#verifySignature(java.lang.String, java.lang.String)"><CODE>Encryptor.verifySignature(String, String)</CODE></A>
 can not be used with expected results across JVM instances. This limitation
 will be addressed in ESAPI 2.1.
 </p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#sign(java.lang.String)">sign</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>data</CODE> - the data to sign
<DT><B>Returns:</B><DD>the digital signature stored as a String
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - if the specified signature algorithm cannot be found</DL>
</DD>
</DL>
<HR>

<A NAME="verifySignature(java.lang.String, java.lang.String)"><!-- --></A><H3>
verifySignature</H3>
<PRE>
public boolean <B>verifySignature</B>(java.lang.String&nbsp;signature,
                               java.lang.String&nbsp;data)</PRE>
<DL>
<DD>Verifies a digital signature (created with the sign method) and returns
 the boolean result.
 <p>
 <b>Limitations:</b> A new public/private key pair used for ESAPI 2.0 digital
 signatures with this method and <A HREF="../../../../../org/owasp/esapi/Encryptor.html#sign(java.lang.String)"><CODE>Encryptor.sign(String)</CODE></A>
 are dynamically created when the default reference implementation class,
 <A HREF="../../../../../org/owasp/esapi/reference/crypto/JavaEncryptor.html" title="class in org.owasp.esapi.reference.crypto"><CODE>JavaEncryptor</CODE></A> is first created.
 Because this key pair is not persisted nor is the public key shared,
 this method and the corresponding <A HREF="../../../../../org/owasp/esapi/Encryptor.html#sign(java.lang.String)"><CODE>Encryptor.sign(String)</CODE></A>
 can not be used with expected results across JVM instances. This limitation
 will be addressed in ESAPI 2.1.
 </p>
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#verifySignature(java.lang.String, java.lang.String)">verifySignature</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>signature</CODE> - the signature to verify against 'data'<DD><CODE>data</CODE> - the data to verify against 'signature'
<DT><B>Returns:</B><DD>true, if the signature is verified, false otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="seal(java.lang.String, long)"><!-- --></A><H3>
seal</H3>
<PRE>
public java.lang.String <B>seal</B>(java.lang.String&nbsp;data,
                             long&nbsp;expiration)
                      throws <A HREF="../../../../../org/owasp/esapi/errors/IntegrityException.html" title="class in org.owasp.esapi.errors">IntegrityException</A></PRE>
<DL>
<DD>Creates a seal that binds a set of data and includes an expiration timestamp.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#seal(java.lang.String, long)">seal</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>expiration</CODE> - <DD><CODE>data</CODE> - the data to seal
<DT><B>Returns:</B><DD>the seal
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/IntegrityException.html" title="class in org.owasp.esapi.errors">IntegrityException</A></CODE></DL>
</DD>
</DL>
<HR>

<A NAME="unseal(java.lang.String)"><!-- --></A><H3>
unseal</H3>
<PRE>
public java.lang.String <B>unseal</B>(java.lang.String&nbsp;seal)
                        throws <A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></PRE>
<DL>
<DD>Unseals data (created with the seal method) and throws an exception
 describing any of the various problems that could exist with a seal, such
 as an invalid seal format, expired timestamp, or decryption error.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#unseal(java.lang.String)">unseal</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>seal</CODE> - the sealed data
<DT><B>Returns:</B><DD>the original (unsealed) data
<DT><B>Throws:</B>
<DD><CODE><A HREF="../../../../../org/owasp/esapi/errors/EncryptionException.html" title="class in org.owasp.esapi.errors">EncryptionException</A></CODE> - if the unsealed data cannot be retrieved for any reason</DL>
</DD>
</DL>
<HR>

<A NAME="verifySeal(java.lang.String)"><!-- --></A><H3>
verifySeal</H3>
<PRE>
public boolean <B>verifySeal</B>(java.lang.String&nbsp;seal)</PRE>
<DL>
<DD>Verifies a seal (created with the seal method) and throws an exception
 describing any of the various problems that could exist with a seal, such
 as an invalid seal format, expired timestamp, or data mismatch.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#verifySeal(java.lang.String)">verifySeal</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>seal</CODE> - the seal to verify
<DT><B>Returns:</B><DD>true, if the seal is valid.  False otherwise</DL>
</DD>
</DL>
<HR>

<A NAME="getTimeStamp()"><!-- --></A><H3>
getTimeStamp</H3>
<PRE>
public long <B>getTimeStamp</B>()</PRE>
<DL>
<DD>Gets a timestamp representing the current date and time to be used by
 other functions in the library.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#getTimeStamp()">getTimeStamp</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>

<DT><B>Returns:</B><DD>a timestamp representing the current time</DL>
</DD>
</DL>
<HR>

<A NAME="getRelativeTimeStamp(long)"><!-- --></A><H3>
getRelativeTimeStamp</H3>
<PRE>
public long <B>getRelativeTimeStamp</B>(long&nbsp;offset)</PRE>
<DL>
<DD>Gets an absolute timestamp representing an offset from the current time to be used by
 other functions in the library.
<P>
<DD><DL>
<DT><B>Specified by:</B><DD><CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html#getRelativeTimeStamp(long)">getRelativeTimeStamp</A></CODE> in interface <CODE><A HREF="../../../../../org/owasp/esapi/Encryptor.html" title="interface in org.owasp.esapi">Encryptor</A></CODE></DL>
</DD>
<DD><DL>
<DT><B>Parameters:</B><DD><CODE>offset</CODE> - the offset to add to the current time
<DT><B>Returns:</B><DD>the absolute timestamp</DL>
</DD>
</DL>
<!-- ========= END OF CLASS DATA ========= -->
<HR>


<!-- ======= START OF BOTTOM NAVBAR ====== -->
<A NAME="navbar_bottom"><!-- --></A>
<A HREF="#skip-navbar_bottom" title="Skip navigation links"></A>
<TABLE BORDER="0" WIDTH="100%" CELLPADDING="1" CELLSPACING="0" SUMMARY="">
<TR>
<TD COLSPAN=2 BGCOLOR="#EEEEFF" CLASS="NavBarCell1">
<A NAME="navbar_bottom_firstrow"><!-- --></A>
<TABLE BORDER="0" CELLPADDING="0" CELLSPACING="3" SUMMARY="">
  <TR ALIGN="center" VALIGN="top">
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../overview-summary.html"><FONT CLASS="NavBarFont1"><B>Overview</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-summary.html"><FONT CLASS="NavBarFont1"><B>Package</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#FFFFFF" CLASS="NavBarCell1Rev"> &nbsp;<FONT CLASS="NavBarFont1Rev"><B>Class</B></FONT>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="class-use/JavaEncryptor.html"><FONT CLASS="NavBarFont1"><B>Use</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="package-tree.html"><FONT CLASS="NavBarFont1"><B>Tree</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../deprecated-list.html"><FONT CLASS="NavBarFont1"><B>Deprecated</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../index-all.html"><FONT CLASS="NavBarFont1"><B>Index</B></FONT></A>&nbsp;</TD>
  <TD BGCOLOR="#EEEEFF" CLASS="NavBarCell1">    <A HREF="../../../../../help-doc.html"><FONT CLASS="NavBarFont1"><B>Help</B></FONT></A>&nbsp;</TD>
  </TR>
</TABLE>
</TD>
<TD ALIGN="right" VALIGN="top" ROWSPAN=3><EM>
</EM>
</TD>
</TR>

<TR>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
&nbsp;<A HREF="../../../../../org/owasp/esapi/reference/crypto/EncryptedPropertiesUtils.html" title="class in org.owasp.esapi.reference.crypto"><B>PREV CLASS</B></A>&nbsp;
&nbsp;<A HREF="../../../../../org/owasp/esapi/reference/crypto/ReferenceEncryptedProperties.html" title="class in org.owasp.esapi.reference.crypto"><B>NEXT CLASS</B></A></FONT></TD>
<TD BGCOLOR="white" CLASS="NavBarCell2"><FONT SIZE="-2">
  <A HREF="../../../../../index.html?org/owasp/esapi/reference/crypto/JavaEncryptor.html" target="_top"><B>FRAMES</B></A>  &nbsp;
&nbsp;<A HREF="JavaEncryptor.html" target="_top"><B>NO FRAMES</B></A>  &nbsp;
&nbsp;<SCRIPT type="text/javascript">
  <!--
  if(window==top) {
    document.writeln('<A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>');
  }
  //-->
</SCRIPT>
<NOSCRIPT>
  <A HREF="../../../../../allclasses-noframe.html"><B>All Classes</B></A>
</NOSCRIPT>


</FONT></TD>
</TR>
<TR>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
  SUMMARY:&nbsp;NESTED&nbsp;|&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_summary">METHOD</A></FONT></TD>
<TD VALIGN="top" CLASS="NavBarCell3"><FONT SIZE="-2">
DETAIL:&nbsp;FIELD&nbsp;|&nbsp;CONSTR&nbsp;|&nbsp;<A HREF="#method_detail">METHOD</A></FONT></TD>
</TR>
</TABLE>
<A NAME="skip-navbar_bottom"></A>
<!-- ======== END OF BOTTOM NAVBAR ======= -->

<HR>
Copyright &#169; 2011 <a href="http://www.owasp.org/index.php">The Open Web Application Security Project (OWASP)</a>. All Rights Reserved.
</BODY>
</HTML>
